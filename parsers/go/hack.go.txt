func (tk *Tokenizer) Clean(tokens []*Token) []*Token {
	ret := make([]*Token, 0)
	var last *Token
	for _, tok := range tokens {
		// insert optional semicolon
		// The formal grammar uses semicolons ";" as terminators in a number of productions. Go programs may omit most of these semicolons using the following two rules:
		//
		// When the input is broken into tokens, a semicolon is automatically inserted into the token stream immediately after a line's final token if that token is
		// an identifier
		// an integer, floating-point, imaginary, rune, or string literal
		// one of the keywords break, continue, fallthrough, or return
		// one of the operators and punctuation ++, --, ), ], or }
		// To allow complex statements to occupy a single line, a semicolon may be omitted before a closing ")" or "}".
		if tok.Kind == TokenTypeNewline {
			if last != nil && last.Kind != TokenTypeOpSemi {
				insertSemi := false
				switch last.Kind {
				case TokenTypeIdent:
					insertSemi = true
				case TokenTypeString:
					insertSemi = true
				case TokenTypeOpRightParen, TokenTypeOpRightBracket, TokenTypeOpRightBrace:
					// ),],}
					insertSemi = true
				case TokenTypeOpPlusPlus, TokenTypeOpMinusMinus:
					// ++,--
					insertSemi = true
				case TokenTypeNumber:
					insertSemi = true
				case TokenTypeKwFallthrough, TokenTypeKwReturn, TokenTypeKwBreak, TokenTypeKwContinue:
					insertSemi = true
				}

				if insertSemi {
					last = NewToken(TokenTypeOpSemi, last.Start, last.End, []rune(";"))
					ret = append(ret, last)
				}
			}
		}

		if tok.Kind == TokenTypeWhitespace || tok.Kind == TokenTypeNewline || tok.Kind == TokenTypeComment {
			continue
		}

		ret = append(ret, tok)
		last = tok
		if tok.Kind == TokenTypeEndOfFile {
			break
		}
	}
	return ret
}

func (ps *Parser) _setDepth(d int) {
    ps._any = d
}

func (ps *Parser) _getDepth() int {
    return ps._any.(int)
}

func (ps *Parser) _enter() {
	ps._setDepth(ps._bracketDepth + 1)
}

func (ps *Parser) _leave() {
	ps._setDepth(0)
}

func (ps *Parser) _hackCompositeLitNode() Node {
	if ps._bracketDepth >= ps._getDepth() {
		return ps.compositeLit()
	}
	return nil
}